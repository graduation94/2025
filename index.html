<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Graduation Order Checker</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    @font-face {
      font-family: 'GEThuluth';
      src: url('./GE-Thuluth-Light.otf') format('opentype');
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(180deg, #0a0a0a, #1a1a1a);
      color: #e8e8e8;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .card {
      background: rgba(20, 20, 20, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      width: 90%;
      max-width: 420px;
      box-shadow: 0 0 35px rgba(191,161,69,0.1);
      text-align: center;
      padding: 50px 30px;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeUp 1.2s ease forwards;
    }
    @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }
    .logo-box {
      width: 110px; height: 110px; margin: 0 auto 25px; border-radius: 15px;
      border: 2px solid rgba(191,161,69,0.4); overflow: hidden;
      box-shadow: 0 0 15px rgba(191,161,69,0.1);
    }
    .logo-box img { width: 100%; height: 100%; object-fit: cover; border-radius: 15px; display: block; }
    h1 {
      font-size: 1.9rem;
      background: linear-gradient(90deg, #bfa145, #e3cf91);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      font-weight: 600; margin-bottom: 6px; letter-spacing: 0.5px;
    }
    .subtitle { color: #999; margin-bottom: 25px; font-size: 0.95rem; }
    input {
      width: 100%; padding: 12px; border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(255,255,255,0.05); color: #fff; text-align: center;
      font-size: 1rem; outline: none; transition: all 0.3s ease;
    }
    input:focus { border-color: #bfa145; box-shadow: 0 0 6px rgba(191,161,69,0.3); }
    button {
      width: 100%; margin-top: 18px; padding: 12px; border-radius: 10px; border: none;
      background: linear-gradient(90deg, #bfa145, #e3cf91); color: #000;
      font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s ease;
    }
    button:hover { box-shadow: 0 0 25px rgba(191,161,69,0.25); }
    .result {
      margin-top: 25px; background: rgba(255,255,255,0.03);
      border: 1px solid rgba(191,161,69,0.25); border-radius: 15px;
      padding: 25px; opacity: 0; transform: translateY(10px);
      animation: fadeResult 0.6s ease forwards; animation-delay: 0.3s;
    }
    @keyframes fadeResult { to { opacity: 1; transform: translateY(0); } }
    .order-type { color: #e3cf91; font-weight: 600; font-size: 1.05rem; margin-bottom: 10px; }
    .name { font-family: 'GEThuluth'; font-size: 1.6rem; color: #d4af37; margin-bottom: 8px; }
    .size {
      display: inline-block; font-size: 1rem; color: #e8e8e8;
      background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px; padding: 6px 15px; margin-top: 8px; margin-bottom: 12px;
    }
    /* Ù…Ø³Ø§ÙØ§Øª Ø¨Ø³ÙŠØ·Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ØµØ± */
    .mb-6 { margin-bottom: 6px; } .mb-8 { margin-bottom: 8px; } .mb-10 { margin-bottom: 10px; } .mb-14 { margin-bottom: 14px; }

    .message {
      margin-top: 25px; color: #d4af37; font-size: 0.95rem;
      background: rgba(255,255,255,0.03); border: 1px solid rgba(191,161,69,0.25);
      border-radius: 10px; padding: 15px;
    }
    .loader {
      border: 3px solid rgba(255,255,255,0.1); border-top: 3px solid #d4af37;
      border-radius: 50%; width: 28px; height: 28px; margin: 25px auto; animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .footer { margin-top: 25px; font-size: 0.9rem; color: #aaa; font-weight: 500; }
    .footer .gold {
      background: linear-gradient(90deg, #bfa145, #e3cf91);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      font-weight: 600; animation: glow 3s ease-in-out infinite alternate;
    }
    @keyframes glow { from { filter: brightness(1); } to { filter: brightness(1.4); } }
    @media (max-width: 480px) { .card { padding: 35px 20px; } .logo-box { width: 90px; height: 90px; } .name { font-size: 1.4rem; } }
  </style>
</head>
<body>
  <div class="card">
    <div class="logo-box"><img src="./logo.png" alt="Logo"></div>
    <h1>Graduation Team</h1>
    <p class="subtitle">Check your graduation order</p>

    <input type="tel" inputmode="numeric" pattern="[0-9]*" id="seat" placeholder="Enter your ID Number">
    <button id="checkBtn">Check Order</button>

    <div id="result"></div>

    <div class="footer">Programmed by <span class="gold">Albara</span></div>
  </div>

  <script>
    const input = document.getElementById('seat');
    const btn = document.getElementById('checkBtn');
    const resultDiv = document.getElementById('result');
    const norm = v => (v ?? '').toString().trim(); // ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©

    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    input.addEventListener('keypress', (e) => { if (e.key === 'Enter') btn.click(); });

    btn.addEventListener('click', async () => {
      const seat = norm(input.value);
      resultDiv.innerHTML = '';

      if (!seat) {
        resultDiv.innerHTML = `<div class="message">Please enter your seat number.</div>`;
        return;
      }

      // ğŸ”„ loader
      resultDiv.innerHTML = `<div class="loader"></div>`;

      try {
        const res = await fetch('./orders.json?nocache=' + Date.now());
        if (!res.ok) throw new Error('Cannot load orders.json');
        const data = await res.json();

        // âœ… ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨Ù†ÙØ³ Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³
        const students = data.filter(x => norm(x.seat_number) === seat);

        if (students.length === 0) {
          resultDiv.innerHTML = `
            <div class="message">
              This websiteâ€™s data was last updated on <b>Thursday at 11:00 PM</b>.<br>
              If your record doesnâ€™t appear yet, please check back later.
            </div>`;
          return;
        }

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        let html = '';
        students.forEach(s => {
          const orderType = norm(s.order_type).toLowerCase();
          const isItems = orderType.includes('item'); // Ø£ÙŠ Ù†ÙˆØ¹ ÙÙŠÙ‡ "item"

          if (isItems) {
            // Ø¹Ù†Ø§ØµØ± ÙÙ‚Ø·: Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ + Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ (Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…/Ù…Ù‚Ø§Ø³)
            html += `
              <div class="result" style="margin-bottom:18px;">
                <div class="size mb-10">Order Number: ${norm(s.order) || '-'}</div>
                <div class="order-type mb-6" style="color:#e3cf91;">Order Type: ${norm(s.order_type) || '-'}</div>
              </div>
            `;
          } else {
            // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹: Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ â†’ Ø§Ù„Ø§Ø³Ù… â†’ Ø§Ù„Ù…Ù‚Ø§Ø³ â†’ Ø§Ù„Ù†ÙˆØ¹
            const name = s.name_on_robe && s.name_on_robe.toString().toLowerCase() !== 'nan' ? s.name_on_robe : '';
            const size = norm(s.size) || '-';

            html += `
              <div class="result" style="margin-bottom:18px;">
                <div class="size mb-8">Order Number: ${norm(s.order) || '-'}</div>
                ${name ? `<div class="name mb-8">${name}</div>` : ''}
                <div class="size mb-10">Size: ${size}</div>
                <div class="order-type mb-6" style="color:#e3cf91;">Order Type: ${norm(s.order_type) || '-'}</div>
              </div>
            `;
          }
        });

        resultDiv.innerHTML = html;
        input.value = ''; // ØªÙØ±ÙŠØº Ø§Ù„Ø­Ù‚Ù„
      } catch (err) {
        resultDiv.innerHTML = `<div class="message">Error loading data. Please try again.</div>`;
      }
    });
  </script>
</body>
</html>
